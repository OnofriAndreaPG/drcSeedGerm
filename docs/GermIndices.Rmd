---
title: Revisiting germination indices
csl: european-journal-of-agronomy.csl
date: "10 December, 2018"
output:
  html_document:
    keep_md: no
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
bibliography: drcSeedGerm.bib
---

# Introduction

Summarising the results of germination assays by using germination indices is still a very widespread practice. Several indices exist, which have been throughly reviewed by @ranal_how_2006. In an early series of two papers, Brown and Meyer stated that no single index can unambiguously combine the three main features of seed germination (i.e. uniformity, speed and extent) in one single value. Therefore, they concluded that the best approach to data analyses is to use the observed germination data to fit a germination curve, which can be used to describe the whole time-course of germination. If a close fit is obtained, the germination curve can be summarised by using a few derived coefficients.

The above authors suggest the use of non-linear regression, which has become a rather widespread method in literature to derive germination indices from germination curves. Recently, such an approach has been also implemented in the R package 'germinationmetrics' [@aravind_germinationmetrics_2018]. We concur with the curve-fitting suggestion,  although we argue that non-linear regression is not the correct fitting method, as shown in previous papers by several authors, including ourselves [@Hunter1984_SeedGermMethod, @scott_review_1984, @OnofriEtAl2010_Survival, @onofri_cure_2011, @McNair_2012SurvivalSeed, @Ritz2012_CureModel,@hay_modelling_2014, @onofri_experimental_2014, @onofri_hydrothermal-time_2018].

The aim of this work was to consistently reassess the calculation of germination indices within the time-to-event modelling platform, which has already proven useful to account for all peculiarities of seed germination data (including censoring), resulting in reliable estimates of parameters and standard errors. We have also implemented the proposed approach within an user-friendly R package, to make it largely available among seed scientists.

#The example

This dataset was taken from previously published work [@PaceIJA_2010]. Seeds of rapeseed (*Brassica napus* L. var. *oleifera*, cv. Excalibur)  were tested in Petri dishes at different water potentials (-0.03, -0.15, -0.3, -0.4, -0.5, -0.6, -0.7, -0.8, -0.9, -1, -1.1, -1.2, -1.5 MPa), which were created by using a polyethylene glycol solution (PEG 6000). For each water potential level, three replicated Petri dishes with 50 seeds each were incubated at 20 \textdegree C. Germinated seeds were counted and removed every 2-3 days for 14 days. We have already analysed this dataset in a previous paper, where we used it to fit a hydro-time-to-event model [@onofri_hydrothermal-time_2018]. In this case, we propose a different type of analysis, where we aim at obtaining some relevant germination indices per each Petri dish, to be submitted to further analyses. In particular, we would like to obtain:

1. the germination rate for the 10th, 30th and 50th percentile (GR10, GR30 and GR50);
2. the maximum germinated proportion.

The dataset is available within the package 'drcSeedGerm'; the following code loads the package and dataset; if necessary, the 'drcSeedGerm' package needs to be installed from github (follow the link above to home page).

```{r message = F}
library(drcSeedGerm)
data(rape)
head(rape, 10)
```

As we see, the dataset is organised, as necessary for fitting a time-to-event model with the function 'drm()' in the 'drc()' package [@Ritz:2015aa]. In order to get germination indices, we propose that a time-to-event model is fit to each Petri dish and the relevant indices are retreived from the model fit. In particular, if we fit a log-based model in 'drc' (i.e. 'LL.3()', 'W1.3()' or 'W2.3()'), we could retreive the maximum germinated proportion as the parameter 'd' and the GR-values as the inverse og germination times, as obtained by using the 'ED()' function. We show an example with the 23-th Petri dish.

```{r}
library(drc)
mod <- drm(nSeeds ~ timeBef + timeAf, fct = LL.3(),
  data = rape, subset = c(Dish == 23),
  type = "event") 
summary(mod)

ED(mod, c(0.1, 0.3, 0.5), type = "absolute")
```

Please, note that I used the 'type = "absolute"' argument to the 'ED()' function. I wanted to retreive the time to germinations for the 10th, 30th and 50th percentiles, considering the whole seed population and not only the germinated fraction. This is usually considered more appropriate by seed biologists. Germination rates can be obtained as the reciprocal of germination times and standard errors can be obtained by using the delta method; I will not give an example, as it is not needed, here.

The problem now is how to automate the process and calculate these germination indices for all Petri dishes. If we go through the dataset, we see that only a few Petri dishes show a clear germination time-course that would allow a three-parameter log-logistic model to be succesfully fit. Indeed, there might be five different situations:

1. dishes with negligible germination (e.g. less than 10%)
2. dishes where the maximum germinated proportion is reached already at the first germination time
3. dishes not included in 1 or 2, but where, nonetheless, germination models cannot be succesfully fit.
4. dishes with complete germination, where a three-parameter logistic is overparameterised and gives convergence problems. However, a two-parameter logistic ('LL.2()') can be succesfully fit
5. dishes where a three-parameter logistic can be succesfully fit.


For the cases 1, 2 and 3 we might still be able to estimate maximum germinated proportion, germination times and germination rates. Indeed, if our bioassay has been long enough to observe all possible germinations, we could take the final observed germinated proportion. Furthermore, we can obtain germination rates and times by using the non-parametric equations given in @aravind_germinationmetrics_2018. For these estimators, bootstrap standard errors may be easily obtained by resampling the seeds in each Petri dish. 

I have automated this process within the 'drmSG()' function in the 'drcSeedGerm' package and would like to give an example. Please, note that 'drmSG()' is just a wrapper to the 'drm()' function and uses a similar syntax. 

```{r message=F, warning=FALSE}
mod <- drmSG(nSeeds ~ timeBef + timeAf, curveid = Dish,
                       data=rape, fct = "LL", g = c(10, 30, 50)) 
```

What has happened? We can see a brief report.

```{r}
table(mod$report$Code)
```

Wee see that 18 dishes ended with 'Code = 1' (no or negligible germinations), 6 dishes ended with 'Code = 3' (no germination model could be fit), 6 dishes ended with 'Code = 4' ('LL.2()' was fit instead of 'LL.3()') and 12 dishes ended with 'Code = 5' (succesful LL.3() fit).

We can now retreive the model parameters (where a model could be fit)

```{r}
head(mod$coefficients, 10)
```

We can also retreive the final observed germinated proportion for all dishes:

```{r}
head(mod$pFinal, 10)
```

and the GR for the 10th, 30th and 50th percentiles, together with standard errors.

```{r}
head(mod$GRest, 10)
head(mod$GRest.se, 10)

```

#References
